generator mongodbClient {
  provider = "prisma-client-js"
  output   = "../../../../node_modules/.prisma/mongodb"
}

datasource mongodb {
  provider = "mongodb"
  url      = env("DATABASE_URL_MONGODB")
}

model Category {
  id            String     @id @default(auto()) @map("_id") @mongodb.ObjectId
  name          String     @unique
  description   String?
  tenantId      String
  subcategories Category[] @relation("Subcategory")
  parent        Category?  @relation("Subcategory", fields: [parentId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  parentId      String?    @mongodb.ObjectId
  createdAt     DateTime   @default(now())
  updatedAt     DateTime   @updatedAt
  product       Product[]

  @@index([parentId])
}

model Product {
  id                       String                     @id @default(auto()) @map("_id") @mongodb.ObjectId
  productName              String                     @unique
  categoryId               String[]                   @mongodb.ObjectId
  category                 Category                   @relation(fields: [categoryId], references: [id])
  shortDescription         String
  longDescription          String?
  variants                 Variant[]
  type                     Type
  productCover             String
  productMedia             String[]
  taxes                    TaxDetail[]
  availableShippingMethods String[]
  shippingRestrictions     String[]
  tags                     String[]
  installmentPayments      InstallmentDetail[]
  acceptedPaymentMethods   String[]
  sustainability           SustainabilityAttributes[]
  brand                    String?
  manufacturer             String?
  warranty                 WarrantyDetail?
  createdAt                DateTime                   @default(now())
  updatedAt                DateTime                   @updatedAt

  @@index([categoryId])
  @@index([variants.sku])
  @@index([variants.upc])
  @@index([variants.ean])
  @@index([variants.isbn])
  @@index([variants.barcode])
  @@index([variants.atributes.key, variants.atributes.value])
}

// Types for Products
type Variant {
  atributes              Atribute[]
  stock_per_warehouse    StockPerWarehouse[]
  price                  Float               @default(0)
  currency               Currency
  productMedia           String[]
  personalizationOptions String[]
  weight                 Float?
  dimensions             Dimension?
  condition              ProductCondition
  sku                    String?
  upc                    String?
  ean                    String?
  isbn                   String?
  barcode                String?
}

type Atribute {
  key   String
  value String
}

enum Type {
  PHYSICAL
  DIGITAL
}

type StockPerWarehouse {
  warehouseId                String
  qtyAvailable               Int       @default(0)
  qtyReserved                Int       @default(0)
  productLocation            String?
  estimatedReplenishmentDate DateTime?
  lotNumber                  String?
  serialNumbers              String[]
}

enum Currency {
  AFN
  ALL
  EUR
  DZD
  AOA
  XCD
  SAR
  ARS
  AMD
  AWG
  AUD
  AZN
  BSD
  BDT
  BBD
  BHD
  BZD
  XOF
  BMD
  BYR
  MMK
  BOB
  BOV
  USD
  BAM
  BWP
  BRL
  BND
  BGN
  BIF
  BTN
  INR
  CVE
  KHR
  XAF
  CAD
  CLF
  CLP
  CNY
  COP
  COU
  KMF
  CDF
  CRC
  HRK
  CUC
  CUP
  ANG
  DKK
  EGP
  SVC
  AED
  ERN
  ETB
  FJD
  PHP
  XDR
  GMD
  GEL
  GHS
  GIP
  GNF
  GYD
  HTG
  HNL
  HKD
  HUF
  IDR
  IQD
  NOK
  ISK
  KYD
  FKP
  SBD
  ILS
  JMD
  JPY
  GBP
  JOD
  KZT
  KES
  KGS
  KWD
  LSL
  ZAR
  LRD
  LYD
  CHF
  LBP
  MOP
  MKD
  MGA
  MYR
  MWK
  MVR
  MAD
  MUR
  MRO
  MNT
  MZN
  MXN
  MXV
  NAD
  NPR
  NIO
  NGN
  NZD
  XPF
  OMR
  XUA
  PKR
  PAB
  PGK
  PYG
  PEN
  PLN
  QAR
  LAK
  VEF
  CZK
  KRW
  MDL
  KPW
  DOP
  IRR
  TZS
  SYP
  RWF
  RON
  RUB
  WST
  STD
  RSD
  SCR
  SLL
  SGD
  XSU
  SOS
  LKR
  SZL
  SDG
  SSP
  SEK
  CHE
  CHW
  SRD
  THB
  TWD
  TJS
  TOP
  TTD
  TMT
  TRY
  TND
  UGX
  UAH
  UYI
  UYU
  UZS
  VUV
  VND
  YER
  DJF
  ZMW
  ZWL
}

enum ProductCondition {
  NEW
  USED
  REFURBISHED
}

type TaxDetail {
  type    String
  rate    Float
  country String?
}

type Dimension {
  height Float
  width  Float
  depth  Float
}

type InstallmentDetail {
  months       Int
  interestRate Float
}

type SustainabilityAttributes {
  certification      String
  recycledPercentage Float
}

type WarrantyDetail {
  duration     String
  coverage     String
  instructions String
}
